{% extends './includes/mosque_layout.html' %}
{% block stylesheets %}
	<link rel="stylesheet" href="{{ url_for('static', filename='css/select2.min.css') }}">
{% endblock stylesheets %}
{% block mosque_content %}
	<div class="container">
		<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
			{% if session['mosque_name'] %}
				<h1 class="h2">مسجـــد {{  session['mosque_name'] }} </h1>
			{% endif %}
			<div class="btn-toolbar mb-2 mb-md-0">
				{% if 'project_id' in session and session['project_id'] != -1 %}
					<a target="_blank" class="btn btn-outline-primary nav-link" href="{{ url_for('mosque_bp.PrintTable',
															project_id = session['project_id']) }}">طبــــع القائمـة</a>
				{% else %}
					<a target="_blank" class="btn btn-outline-primary nav-link" href="{{ url_for('mosque_bp.PrintTable',
																			project_id = -1) }}">طبــــع القائمـة</a>
				{% endif %}

			</div>
		</div>
		<div class="row justify-content-right">
			<div class="col-md">
				<form method="post" action="{{ url_for('mosque_bp.list_garants', page = 1) }}">
					{{ form.hidden_tag() }}
					<div class="form-row">
						<div class="col-md">
							{{ form.projects.label(class="form-control-label") }}
							{% if form.projects.errors %}
								{{ form.projects(class="select-project form-control form-control-md", onchange="form.submit()") }}
								{% for error in form.projects.errors %}
									<div class="alert alert-danger">
										{{error}}
									</div>
								{% endfor %}
							{% else %}
								{{ form.projects(class="select-project form-control form-control-md", onchange="form.submit()") }}
							{% endif %}
						</div>
					</div>
				</form>
			</div>
		</div>
		<div class="row justify-content-center">
			<div class="col-md">
				<div class="card shadow-lg border-0 rounded-lg mt-5">
					<div class="card-header">
						<div class="row">
							<div class="col-md">
								<h3 class="h3">
									المحتاجيــن
								</h3>
							</div>
							<div class="col-md text-right">
								<a class="btn btn-outline-primary" href="{{ url_for('mosque_bp.register_garants') }}">
									<i class="fa fa-plus"></i></a>
							</div>
						</div>
					</div>
					{% include "includes/ui-table.html" %}
				</div>
			</div>
		</div>
	</div>
{#
<main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
	<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
		{% if content['name']%}
			<h1 class="h2">مسجـــد {{ content['name']}} </h1>
		{% endif %}
		<div class="btn-toolbar mb-2 mb-md-0">
				
			<a target="_blank" class="btn nav-link" href="{{ url_for('print_table') }}">طبــــع القائمـة</a>
		
		</div>
	</div>
		<div class="dropdown">
			<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				عرض القائمـة حسب المشروع
			</button>
			<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
					<a class="dropdown-item" href="{{ url_for('list_garants', argument='*') }}">
						الكـــل
					</a>
					<a class="dropdown-item" href="{{ url_for('list_garants',  argument='prime_m')}}">المنحة الشهرية
					</a>
					<a class="dropdown-item" href="{{ url_for('list_garants', argument='prime_s' )}}">منحـة التمدرس</a>
			</div>
		  </div>
			{%if content['data'] %}
			<div class="table-responsive">
				<table class="table table-bordered table-hover">
					<thead>
						<tr>
							{% with columns = content['columns'] %}
								{% if columns %}
									{% for colonne in columns %}
										<th>{{colonne}}</th>
									{% endfor %}
								{% endif %}
							{% endwith %}
							<th>عمليات</th>
						</tr>
					</thead>
					<tbody>
						{% for line in content['data'] %}
							<tr>
								<td>{{line.id}}</td>
								<td>{{line.prenom}}</td>
								<td>{{line.nom}}</td>
								<td>{{line.date_nais}}</td>
								<td>{{line.Solde_part_financiere}}</td>
								<td align="center"><a href="{{url_for('print_form', arg=line.id)}}" target="_blank" class="btn btn-info btn-sm">طبـــاعة</a></td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
			{% else %}
				<div class="alert alert-info text-center">
					<span>  لا يوجـــد</span>
				</div>
			{% endif %}

</main>
#}
{% endblock mosque_content %}

{% block scripts %}
	<script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
	<script src="{{ url_for('static', filename='js/select2.min.js') }}"></script>
	<script>
		$(document).ready( function () {
			$('.select-project').select2();
			$('#ui-table').DataTable({
				"bPaginate": false,
				"fixedColumns":   true,
				"info":     false,
				"language": {
					"url": "{{url_for('static', filename='DataTables/Arabic.json')}}"
				}
			});
		});
	</script>
{% endblock scripts %}